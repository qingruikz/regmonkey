# regmonkey

[English](README.md) | [æ—¥æœ¬èª](README.ja.md) | [ä¸­æ–‡](README.zh.md)

**regmonkey** æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ Python åŒ…ï¼Œæ—¨åœ¨ç®€åŒ–æ•°æ®åˆ†æå’Œå›å½’å»ºæ¨¡ä»»åŠ¡ã€‚å®ƒç®€åŒ–äº†æè¿°æ€§ç»Ÿè®¡ã€è™šæ‹Ÿå˜é‡åˆ›å»ºã€å›å½’æ¨¡å‹ä¼°è®¡å’Œå¸¦æ³¨é‡Šçš„ Excel æ–‡ä»¶å¯¼å‡ºç­‰ä»»åŠ¡ã€‚

## ç‰¹ç‚¹

- ğŸ“Š **æè¿°æ€§ç»Ÿè®¡**: è½»æ¾ä» DataFrame ç”Ÿæˆæ¸…æ™°ä¸”å››èˆäº”å…¥çš„æ±‡æ€»ç»Ÿè®¡ã€‚
- ğŸ§  **æ™ºèƒ½å˜é‡è§£æ**: è‡ªåŠ¨è§£é‡Šå¯¹æ•°è½¬æ¢ã€å¤šé¡¹å¼é¡¹å’Œäº¤äº’é¡¹ã€‚
- ğŸ“¦ **è™šæ‹Ÿå˜é‡åˆ›å»º**: å¿«é€Ÿå°†åˆ†ç±»å˜é‡è½¬æ¢ä¸ºè™šæ‹Ÿ/æŒ‡æ ‡å˜é‡ã€‚
- ğŸ“ˆ **å›å½’åˆ†æ**: è¿è¡Œæ”¯æŒå¯¹æ•°ã€å¹‚å’Œäº¤äº’é¡¹çš„å¤šå…ƒçº¿æ€§å›å½’ï¼Œå¹¶å¯¼å‡ºæ ¼å¼è‰¯å¥½çš„ç»“æœè¡¨ã€‚
- ğŸ“„ **Excel é¡µè„šæ³¨é‡Š**: è‡ªåŠ¨å‘ Excel æ–‡ä»¶æ·»åŠ æ³¨é‡Šã€‚
- ğŸŒ **å¤šè¯­è¨€æ”¯æŒ**: æ”¯æŒä½¿ç”¨æ—¥è¯­ã€è‹±è¯­æˆ–ä¸­æ–‡æŒ‡å®šå˜é‡ï¼Œè‡ªåŠ¨æ£€æµ‹è¯­è¨€å¹¶æä¾›ä¸€è‡´çš„ç»“æœè¾“å‡ºæ ¼å¼ã€‚

## å®‰è£…

```bash
pip install regmonkey
```

## å‡½æ•°

### `add_footer(file_path, value, sheet_name=None)`

å‘ Excel å·¥ä½œè¡¨çš„æœ€åä¸€è¡Œæ·»åŠ æ³¨é‡Šã€‚

**å‚æ•°**:

- `file_path` (str): Excel æ–‡ä»¶çš„è·¯å¾„ã€‚
- `value` (str): æ³¨é‡Šçš„å†…å®¹ã€‚
- `sheet_name` (str, å¯é€‰): è¦ä¿®æ”¹çš„å·¥ä½œè¡¨åç§°ã€‚é»˜è®¤ä¸ºç¬¬ä¸€ä¸ªå·¥ä½œè¡¨ã€‚

**ç¤ºä¾‹**:

```python
from regmonkey.stats import add_footer

add_footer("example.xlsx", "æ³¨ï¼šæ•°æ®ä¸ºåˆæ­¥ç‰ˆæœ¬ã€‚", sheet_name="Sheet1")
```

---

### `get_dummies(df, columns)`

å°†åˆ†ç±»å˜é‡è½¬æ¢ä¸ºè™šæ‹Ÿ/æŒ‡æ ‡å˜é‡ã€‚

**å‚æ•°**:

- `df` (DataFrame): è¾“å…¥ DataFrameã€‚
- `columns` (str åˆ—è¡¨): è¦è½¬æ¢çš„åˆ—ååˆ—è¡¨ã€‚

**è¿”å›å€¼**:

- åŒ…å«è™šæ‹Ÿå˜é‡çš„æ–° DataFrameã€‚

**ç¤ºä¾‹**:

```python
from regmonkey.stats import get_dummies
import pandas as pd

data = pd.DataFrame({"Year": ["2020", "2021", "2022"], "Value": [10, 20, 30]})
dummies = get_dummies(data, columns=["Year"])
print(dummies)
```

---

### `summary(df, var_list)`

ç”Ÿæˆå˜é‡åˆ—è¡¨çš„æè¿°æ€§ç»Ÿè®¡ã€‚

**å‚æ•°**:

- `df` (DataFrame): è¾“å…¥ DataFrameã€‚
- `var_list` (str åˆ—è¡¨): è¦æ±‡æ€»çš„å˜é‡ååˆ—è¡¨ã€‚

**è¿”å›å€¼**:

- åŒ…å«æè¿°æ€§ç»Ÿè®¡çš„ DataFrameã€‚

**ç¤ºä¾‹**:

```python
from regmonkey.stats import summary
import pandas as pd

data = pd.DataFrame({"A": [1, 2, 3], "B": [4, 5, 6]})
stats = summary(data, ["A", "B"])
print(stats)
```

---

### `regression(variables_dicts, df, decimal_places=2)`

æ‰§è¡Œæ”¯æŒå¯¹æ•°ã€å¹‚å’Œäº¤äº’é¡¹çš„å›å½’åˆ†æã€‚

**å‚æ•°**:

- `variables_dicts` (dict åˆ—è¡¨): æŒ‡å®šå› å˜é‡å’Œè‡ªå˜é‡çš„å­—å…¸åˆ—è¡¨ã€‚
  - **å¤šè¯­è¨€æ”¯æŒ**: å¯ä»¥ä½¿ç”¨ä¸åŒè¯­è¨€çš„å˜é‡é”®ï¼š
    - æ—¥è¯­: `{"è¢«èª¬æ˜å¤‰æ•°": "Y", "èª¬æ˜å¤‰æ•°": ["X1", "X2"]}`
    - è‹±è¯­: `{"y": "Y", "X": ["X1", "X2"]}`
    - ä¸­æ–‡: `{"è¢«è§£é‡Šå˜é‡": "Y", "è§£é‡Šå˜é‡": ["X1", "X2"]}`
  - **å¯¹æ•°é¡¹**: ä½¿ç”¨`log(X1)`è¡¨ç¤º`X1`çš„è‡ªç„¶å¯¹æ•°ã€‚
  - **å¹‚é¡¹**: ä½¿ç”¨`X2**2`æˆ–`X2**3`è¡¨ç¤º`X2`çš„å¹³æ–¹æˆ–ç«‹æ–¹ã€‚
  - **è™šæ‹Ÿå˜é‡**: å¯¹äºäºŒå…ƒå˜é‡ï¼Œç›´æ¥ä½¿ç”¨ï¼ˆå¦‚`['æ€§åˆ«']`ï¼‰ã€‚å¯¹äºåˆ†ç±»å˜é‡ï¼Œä½¿ç”¨`get_dummies`é¢„å¤„ç†ï¼ˆå¦‚`['å¹´ä»½_1990', 'å¹´ä»½_1995']`ï¼‰ã€‚
  - **äº¤äº’é¡¹**: ä½¿ç”¨`X1:X2`è¡¨ç¤º`X1`å’Œ`X2`çš„äº¤äº’ä½œç”¨ï¼Œæˆ–ç»„åˆè½¬æ¢å¦‚`X1**2:log(X2)`ã€‚
- `df` (DataFrame): è¾“å…¥æ•°æ®ã€‚
- `decimal_places` (int): ç»“æœçš„å°æ•°ä½æ•°ã€‚

**è¿”å›å€¼**:

- åŒ…å«ä»¥ä¸‹å†…å®¹çš„å…ƒç»„ï¼š
  1. å¤„ç†åçš„ DataFrameã€‚
  2. ä½¿ç”¨å˜é‡çš„æè¿°æ€§ç»Ÿè®¡ã€‚
  3. å›å½’ç»“æœè¡¨ã€‚

**ç¤ºä¾‹**:

```python
from regmonkey.stats import regression
import pandas as pd

# ç¤ºä¾‹æ•°æ®
data = pd.DataFrame({
    "X1": [1, 2, 3],
    "X2": [4, 5, 6],
    "Y": [7, 8, 9],
    "Category": ["A", "B", "A"]
})

# åˆ†ç±»å˜é‡é¢„å¤„ç†
data_with_dummies = pd.get_dummies(data, columns=["Category"])

# å®šä¹‰å›å½’å˜é‡ï¼ˆä¸­æ–‡ï¼‰
variables_zh = [
    {"è¢«è§£é‡Šå˜é‡": "Y", "è§£é‡Šå˜é‡": ["X1", "X2", "log(X1)", "X2**2", "X1:X2"]}
]

# å®šä¹‰å›å½’å˜é‡ï¼ˆè‹±è¯­ï¼‰
variables_en = [
    {"y": "Y", "X": ["X1", "X2", "log(X1)", "X2**2", "X1:X2"]}
]

# å®šä¹‰å›å½’å˜é‡ï¼ˆæ—¥è¯­ï¼‰
variables_ja = [
    {"è¢«èª¬æ˜å¤‰æ•°": "Y", "èª¬æ˜å¤‰æ•°": ["X1", "X2", "log(X1)", "X2**2", "X1:X2"]}
]

# æ‰§è¡Œå›å½’åˆ†æï¼ˆä½¿ç”¨ä¸Šè¿°ä»»ä¸€å˜é‡å®šä¹‰ï¼‰
df_processed, summary_result, regression_result = regression(variables_zh, data_with_dummies)

# æ‰“å°ç»“æœ
print(regression_result)
```

åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼š

- å›å½’å¯ä»¥ä½¿ç”¨æ”¯æŒçš„è¯­è¨€ï¼ˆä¸­æ–‡ã€è‹±è¯­ã€æ—¥è¯­ï¼‰ä¸­çš„ä»»ä½•ä¸€ç§æ¥æŒ‡å®šã€‚
- `log(X1)`è®¡ç®—`X1`çš„è‡ªç„¶å¯¹æ•°ã€‚
- `X2**2`è®¡ç®—`X2`çš„å¹³æ–¹ã€‚
- `X1:X2`è®¡ç®—`X1`å’Œ`X2`çš„äº¤äº’ä½œç”¨ã€‚
- `Category`çš„è™šæ‹Ÿå˜é‡ä½¿ç”¨`get_dummies`è‡ªåŠ¨åˆ›å»ºã€‚
- è¾“å‡ºæ ‡ç­¾ï¼ˆå¦‚"æ ·æœ¬æ•°"/"N"/"è¦³æ¸¬æ•°"ï¼‰ä¼šè‡ªåŠ¨åŒ¹é…è¾“å…¥é”®çš„è¯­è¨€ã€‚

---

## ä½¿ç”¨ç¤ºä¾‹

```python
import pandas as pd
from regmonkey.stats import get_dummies, regression, add_footer

# åŠ è½½æ•°æ®
data = pd.DataFrame({
    "X1": [1, 2, 3],
    "X2": [4, 5, 6],
    "Y": [7, 8, 9],
    "Category": ["A", "B", "A"]
})

# åˆ›å»ºè™šæ‹Ÿå˜é‡
data_with_dummies = get_dummies(data, columns=["Category"])

# æ‰§è¡ŒåŒ…å«å¯¹æ•°ã€å¹‚å’Œäº¤äº’é¡¹çš„å›å½’åˆ†æï¼ˆä½¿ç”¨ä¸­æ–‡é”®ï¼‰
variables = [
    {"è¢«è§£é‡Šå˜é‡": "Y", "è§£é‡Šå˜é‡": ["X1", "X2", "log(X1)", "X2**2", "X1:X2"]}
]
df_processed, summary_result, regression_result = regression(variables, data_with_dummies)

# å°†å›å½’ç»“æœä¿å­˜åˆ°Excelå¹¶æ·»åŠ æ³¨é‡Š
regression_result.to_excel("regression_results.xlsx", index=False)
add_footer("regression_results.xlsx", "æ³¨ï¼šå›å½’ç»“æœåŒ…å«å¯¹æ•°ã€å¹‚å’Œäº¤äº’é¡¹ã€‚")

# å°†æè¿°æ€§ç»Ÿè®¡ä¿å­˜åˆ°Excelå¹¶æ·»åŠ æ³¨é‡Š
summary_result.to_excel("summary_statistics.xlsx", index=False)
add_footer("summary_statistics.xlsx", "æ³¨ï¼šå›å½’åˆ†æä¸­ä½¿ç”¨çš„æ‰€æœ‰å˜é‡çš„æè¿°æ€§ç»Ÿè®¡ã€‚")
```
