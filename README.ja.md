# regmonkey

[English](README.md) | [æ—¥æœ¬èª](README.ja.md) | [ä¸­æ–‡](README.zh.md)

**regmonkey** ã¯ã€ãƒ‡ãƒ¼ã‚¿åˆ†æã¨å›å¸°ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã®ã‚¿ã‚¹ã‚¯ã‚’åŠ¹ç‡åŒ–ã™ã‚‹ãŸã‚ã®è»½é‡ãª Python ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã™ã€‚è¨˜è¿°çµ±è¨ˆã€ãƒ€ãƒŸãƒ¼å¤‰æ•°ã®ä½œæˆã€å›å¸°ãƒ¢ãƒ‡ãƒ«ã®æ¨å®šã€æ³¨é‡ˆä»˜ã Excel ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãªã©ã®ã‚¿ã‚¹ã‚¯ã‚’ç°¡ç´ åŒ–ã—ã¾ã™ã€‚

## æ©Ÿèƒ½

- ğŸ“Š **è¨˜è¿°çµ±è¨ˆ**ï¼šDataFrame ã‹ã‚‰ã‚¯ãƒªãƒ¼ãƒ³ã§ä¸¸ã‚ã‚‰ã‚ŒãŸè¦ç´„çµ±è¨ˆã‚’ç°¡å˜ã«ç”Ÿæˆã€‚
- ğŸ§  **ã‚¹ãƒãƒ¼ãƒˆå¤‰æ•°è§£æ**ï¼šå¯¾æ•°å¤‰æ›ã€å¤šé …å¼é …ã€äº¤äº’ä½œç”¨é …ã‚’è‡ªå‹•çš„ã«è§£é‡ˆã€‚
- ğŸ“¦ **ãƒ€ãƒŸãƒ¼å¤‰æ•°ä½œæˆ**ï¼šã‚«ãƒ†ã‚´ãƒªã‚«ãƒ«å¤‰æ•°ã‚’ãƒ€ãƒŸãƒ¼/æŒ‡æ¨™å¤‰æ•°ã«ç´ æ—©ãå¤‰æ›ã€‚
- ğŸ“ˆ **å›å¸°åˆ†æ**ï¼šå¯¾æ•°ã€ã¹ãä¹—ã€äº¤äº’ä½œç”¨é …ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹è¤‡æ•°ã®ç·šå½¢å›å¸°ã‚’å®Ÿè¡Œã—ã€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã•ã‚ŒãŸçµæœè¡¨ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã€‚
- ğŸ“„ **Excel ãƒ•ãƒƒã‚¿ãƒ¼æ³¨é‡ˆ**ï¼šExcel ãƒ•ã‚¡ã‚¤ãƒ«ã«è‡ªå‹•çš„ã«è„šæ³¨ã‚’è¿½åŠ ã€‚
- ğŸŒ **å¤šè¨€èªã‚µãƒãƒ¼ãƒˆ**ï¼šã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹è¨€èªï¼ˆè‹±èªã€æ—¥æœ¬èªã€ä¸­å›½èªï¼‰ã§å¤‰æ•°ã‚’æŒ‡å®šã—ã€`lang` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¦å‡ºåŠ›è¨€èªã‚’ç‹¬ç«‹ã—ã¦åˆ¶å¾¡ã—ã€ã™ã¹ã¦ã®çµæœã§ä¸€è²«ã—ãŸãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’ç¶­æŒã€‚

![](https://raw.githubusercontent.com/qingruikz/regmonkey/main/assets/example.png)

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
pip install regmonkey
```

## é–¢æ•°

### `add_footer(file_path, value, sheet_name=None)`

Excel ã‚·ãƒ¼ãƒˆã®æœ€å¾Œã®è¡Œã«è„šæ³¨ã‚’è¿½åŠ ã—ã¾ã™ã€‚

**å¼•æ•°**ï¼š

- `file_path` (str)ï¼šExcel ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã€‚
- `value` (str)ï¼šè„šæ³¨ã®å†…å®¹ã€‚
- `sheet_name` (str, ã‚ªãƒ—ã‚·ãƒ§ãƒ³)ï¼šä¿®æ­£ã™ã‚‹ã‚·ãƒ¼ãƒˆåã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯æœ€åˆã®ã‚·ãƒ¼ãƒˆã€‚

**ä¾‹**ï¼š

```python
from regmonkey.stats import add_footer

add_footer("example.xlsx", "æ³¨ï¼šãƒ‡ãƒ¼ã‚¿ã¯æš«å®šå€¤ã§ã™ã€‚", sheet_name="Sheet1")
```

---

### `get_dummies(df, columns)`

ã‚«ãƒ†ã‚´ãƒªã‚«ãƒ«å¤‰æ•°ã‚’ãƒ€ãƒŸãƒ¼/æŒ‡æ¨™å¤‰æ•°ã«å¤‰æ›ã—ã¾ã™ã€‚

**å¼•æ•°**ï¼š

- `df` (DataFrame)ï¼šå…¥åŠ› DataFrameã€‚
- `columns` (str ã®ãƒªã‚¹ãƒˆ)ï¼šå¤‰æ›ã™ã‚‹åˆ—åã®ãƒªã‚¹ãƒˆã€‚

**æˆ»ã‚Šå€¤**ï¼š

- ãƒ€ãƒŸãƒ¼å¤‰æ•°ã‚’å«ã‚€æ–°ã—ã„ DataFrameã€‚

**ä¾‹**ï¼š

```python
from regmonkey.stats import get_dummies
import pandas as pd

data = pd.DataFrame({"Year": ["2020", "2021", "2022"], "Value": [10, 20, 30]})
dummies = get_dummies(data, columns=["Year"])
print(dummies)
```

---

### `summary(df, var_list, round_digits=2, lang="ja")`

æŒ‡å®šã•ã‚ŒãŸå¤‰æ•°ã®è¨˜è¿°çµ±è¨ˆé‡ã‚’è¨ˆç®—ã—ã¾ã™ã€‚

- `df`ï¼šãƒ‡ãƒ¼ã‚¿ã‚’å«ã‚€ DataFrame
- `var_list`ï¼šå¤‰æ•°åã®ãƒªã‚¹ãƒˆ
- `round_digits`ï¼šå°æ•°ç‚¹ä»¥ä¸‹ã®æ¡æ•°ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼š2ï¼‰
- `lang`ï¼šå‡ºåŠ›ãƒ©ãƒ™ãƒ«ã®è¨€èªã‚³ãƒ¼ãƒ‰ï¼ˆ"ja"ã€"en"ã€"zh"ï¼‰ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼š"ja"ï¼‰

**æ³¨æ„**ï¼šãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼ˆ`lang` ãŒæŒ‡å®šã•ã‚Œã¦ã„ãªã„å ´åˆï¼‰ã§ã¯ã€å‡ºåŠ›ã¯æ—¥æœ¬èªã«ãªã‚Šã¾ã™ã€‚

ä»¥ä¸‹ã®çµ±è¨ˆé‡ã‚’å«ã‚€ DataFrame ã‚’è¿”ã—ã¾ã™ï¼š

- è¦³æ¸¬æ•°
- å¹³å‡å€¤
- æ¨™æº–åå·®
- æœ€å°å€¤
- æœ€å¤§å€¤

ä¾‹ï¼š

```python
# ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼ˆæ—¥æœ¬èªãƒ©ãƒ™ãƒ«ï¼‰
summary_stats = summary(df, ["X1", "X2"])

# è‹±èªãƒ©ãƒ™ãƒ«
summary_stats = summary(df, ["X1", "X2"], lang="en")

# æ—¥æœ¬èªãƒ©ãƒ™ãƒ«
summary_stats = summary(df, ["X1", "X2"], lang="ja")

# ä¸­å›½èªãƒ©ãƒ™ãƒ«
summary_stats = summary(df, ["X1", "X2"], lang="zh")
```

---

### `regress(variables_dicts, df, decimal_places=2, lang="ja")`

å¯¾æ•°ã€ã¹ãä¹—ã€äº¤äº’ä½œç”¨é …ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹å›å¸°åˆ†æã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

**å¼•æ•°**ï¼š

- `variables_dicts` (è¾æ›¸ã®ãƒªã‚¹ãƒˆ)ï¼šå¾“å±å¤‰æ•°ã¨ç‹¬ç«‹å¤‰æ•°ã‚’æŒ‡å®šã™ã‚‹è¾æ›¸ã®ãƒªã‚¹ãƒˆã€‚
  - **å¤šè¨€èªã‚µãƒãƒ¼ãƒˆ**ï¼šç•°ãªã‚‹è¨€èªã®å¤‰æ•°ã‚­ãƒ¼ã‚’ä½¿ç”¨ã§ãã¾ã™ï¼š
    - æ—¥æœ¬èªï¼š`{"è¢«èª¬æ˜å¤‰æ•°": "Y", "èª¬æ˜å¤‰æ•°": ["X1", "X2"]}`
    - è‹±èªï¼š`{"y": "Y", "X": ["X1", "X2"]}`
    - ä¸­å›½èªï¼š`{"è¢«è§£é‡Šå˜é‡": "Y", "è§£é‡Šå˜é‡": ["X1", "X2"]}`
  - **å¯¾æ•°é …**ï¼š`X1` ã®è‡ªç„¶å¯¾æ•°ã«ã¯ `log(X1)` ã‚’ä½¿ç”¨ã€‚
  - **ã¹ãä¹—é …**ï¼š2 ä¹—ã¾ãŸã¯ 3 ä¹—é …ã«ã¯ `X2**2` ã¾ãŸã¯ `X2**3` ã‚’ä½¿ç”¨ã€‚
  - **ãƒ€ãƒŸãƒ¼å¤‰æ•°**ï¼šäºŒå€¤å¤‰æ•°ã®å ´åˆã¯ç›´æ¥ä½¿ç”¨ï¼ˆä¾‹ï¼š`['Gender']`ï¼‰ã€‚ã‚«ãƒ†ã‚´ãƒªã‚«ãƒ«å¤‰æ•°ã®å ´åˆã¯ã€`get_dummies` ã§ DataFrame ã‚’å‰å‡¦ç†ï¼ˆä¾‹ï¼š`['Year_1990', 'Year_1995']`ï¼‰ã€‚
  - **äº¤äº’ä½œç”¨é …**ï¼š`X1` ã¨ `X2` ã®äº¤äº’ä½œç”¨ã«ã¯ `X1:X2` ã‚’ä½¿ç”¨ã€ã¾ãŸã¯ `X1**2:log(X2)` ã®ã‚ˆã†ãªå¤‰æ›ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã€‚
- `df` (DataFrame)ï¼šå…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã€‚
- `decimal_places` (int)ï¼šçµæœã®å°æ•°ç‚¹ä»¥ä¸‹ã®æ¡æ•°ã€‚
- `lang` (str)ï¼šå‡ºåŠ›ãƒ©ãƒ™ãƒ«ã®è¨€èªã‚³ãƒ¼ãƒ‰ï¼ˆ"ja"ã€"en"ã€"zh"ï¼‰ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼š"ja"ï¼‰

**æ³¨æ„**ï¼šãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼ˆ`lang` ãŒæŒ‡å®šã•ã‚Œã¦ã„ãªã„å ´åˆï¼‰ã§ã¯ã€å‡ºåŠ›ã¯æ—¥æœ¬èªã«ãªã‚Šã¾ã™ã€‚

**æˆ»ã‚Šå€¤**ï¼š

- ä»¥ä¸‹ã®å†…å®¹ã‚’å«ã‚€ã‚¿ãƒ—ãƒ«ï¼š
  1. å‡¦ç†æ¸ˆã¿ã® DataFrameã€‚
  2. ä½¿ç”¨ã—ãŸå¤‰æ•°ã®è¨˜è¿°çµ±è¨ˆé‡ã€‚
  3. å›å¸°çµæœè¡¨ã€‚

**ä¾‹**ï¼š

```python
from regmonkey.stats import regression
import pandas as pd

# ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿
data = pd.DataFrame({
    "X1": [1, 2, 3],
    "X2": [4, 5, 6],
    "Y": [7, 8, 9],
    "Category": ["A", "B", "A"]
})

# ã‚«ãƒ†ã‚´ãƒªã‚«ãƒ«å¤‰æ•°ã®å‰å‡¦ç†
data_with_dummies = pd.get_dummies(data, columns=["Category"])

# å›å¸°å¤‰æ•°ã®å®šç¾©ï¼ˆæ—¥æœ¬èªï¼‰
variables_ja = [
    {"è¢«èª¬æ˜å¤‰æ•°": "Y", "èª¬æ˜å¤‰æ•°": ["X1", "X2", "log(X1)", "X2**2", "X1:X2"]}
]

# å›å¸°å¤‰æ•°ã®å®šç¾©ï¼ˆè‹±èªï¼‰
variables_en = [
    {"y": "Y", "X": ["X1", "X2", "log(X1)", "X2**2", "X1:X2"]}
]

# å›å¸°å¤‰æ•°ã®å®šç¾©ï¼ˆä¸­å›½èªï¼‰
variables_zh = [
    {"è¢«è§£é‡Šå˜é‡": "Y", "è§£é‡Šå˜é‡": ["X1", "X2", "log(X1)", "X2**2", "X1:X2"]}
]

# ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå‡ºåŠ›ã§å›å¸°ã‚’å®Ÿè¡Œï¼ˆæ—¥æœ¬èªï¼‰
df_processed, summary_result, regression_result = regress(variables_ja, data_with_dummies)

# æ—¥æœ¬èªå‡ºåŠ›ã§å›å¸°ã‚’å®Ÿè¡Œ
df_processed, summary_result, regression_result = regress(variables_ja, data_with_dummies, lang="ja")

# è‹±èªå‡ºåŠ›ã§å›å¸°ã‚’å®Ÿè¡Œ
df_processed, summary_result, regression_result = regress(variables_en, data_with_dummies, lang="en")

# ä¸­å›½èªå‡ºåŠ›ã§å›å¸°ã‚’å®Ÿè¡Œ
df_processed, summary_result, regression_result = regress(variables_zh, data_with_dummies, lang="zh")

# çµæœã‚’è¡¨ç¤º
print(regression_result)
```

---

## ä½¿ç”¨ä¾‹

```python
import pandas as pd
from regmonkey.stats import get_dummies, regress, add_footer

# ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿
data = pd.DataFrame({
    "X1": [1, 2, 3],
    "X2": [4, 5, 6],
    "Y": [7, 8, 9],
    "Category": ["A", "B", "A"]
})

# ãƒ€ãƒŸãƒ¼å¤‰æ•°ã®ä½œæˆ
data_with_dummies = get_dummies(data, columns=["Category"])

# å¯¾æ•°ã€ã¹ãä¹—ã€äº¤äº’ä½œç”¨é …ã‚’å«ã‚€å›å¸°ã‚’å®Ÿè¡Œï¼ˆè‹±èªã‚­ãƒ¼ã‚’ä½¿ç”¨ï¼‰
variables = [
    {"y": "Y", "X": ["X1", "X2", "log(X1)", "X2**2", "X1:X2"]}
]
df_processed, summary_result, regression_result = regress(variables, data_with_dummies, lang="en")

# å›å¸°çµæœã‚’ Excel ã«ä¿å­˜ã—ã€è„šæ³¨ã‚’è¿½åŠ 
regression_result.to_excel("regression_results.xlsx", index=False)
add_footer("regression_results.xlsx", "æ³¨ï¼šå›å¸°çµæœã«ã¯å¯¾æ•°ã€ã¹ãä¹—ã€äº¤äº’ä½œç”¨é …ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚")

# è¦ç´„çµ±è¨ˆé‡ã‚’ Excel ã«ä¿å­˜ã—ã€è„šæ³¨ã‚’è¿½åŠ 
summary_result.to_excel("summary_statistics.xlsx", index=False)
add_footer("summary_statistics.xlsx", "æ³¨ï¼šå›å¸°åˆ†æã§ä½¿ç”¨ã—ãŸã™ã¹ã¦ã®å¤‰æ•°ã®è¦ç´„çµ±è¨ˆé‡ã€‚")
```
